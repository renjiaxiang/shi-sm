<?php
 goto ukfJ7; O4WxK: $erweima = $qrcode . $picture_attach; goto LPQlF; uQsVx: $gzwxapp = pdo_get("\154\142\163\x68\137\x67\172\x77\170\x61\160\x70", array("\165\156\x69\x61\x63\x69\x64" => $_W["\165\156\151\141\143\151\x64"])); goto DZXCY; cHitc: $set_txt = "\x74\171\x70\x65\137\x67\x7a\171\x71"; goto S2mo9; zenN1: load()->library("\161\x72\143\x6f\144\x65"); goto hlh35; xeo2k: $picture_attach = "\x51\x52\55\147\x7a\x79\161\x2e\160\x6e\x67"; goto ziRiP; dnqWJ: function getThumb($sFile, $hFile, $iWidth, $iHeight) { goto ujRTO; QG4q0: LdL9N: goto uoaoV; cxaCK: if (file_exists($public_path . $sFileNameS)) { goto cyvO4; } goto k2Eci; k2Eci: return $sFile; goto N1Uwo; T94d6: gPP5o: goto jk57d; DJLOX: return $sFile; goto yCmZg; OpNCz: $attach_fileext = strtolower($extend[count($extend) - 1]); goto PD7_s; p81nx: if (file_exists($public_path . $sFile)) { goto Gy8w1; } goto DJLOX; aZuA_: if (!file_exists($public_path . $sFileNameS)) { goto gPP5o; } goto IP7zl; ujRTO: $public_path = ''; goto p81nx; IP7zl: return $sFileNameS; goto T94d6; Kf2hg: return ''; goto QG4q0; QE9Ke: $extend = explode("\56", $sFile); goto OpNCz; uoaoV: $sFileNameS = $hFile; goto aZuA_; jk57d: resizeImage($public_path . $sFile, $public_path . $sFileNameS, $iWidth, $iHeight); goto cxaCK; N1Uwo: cyvO4: goto FV9A2; yCmZg: Gy8w1: goto QE9Ke; PD7_s: if (in_array($attach_fileext, array("\x6a\160\147", "\160\156\x67", "\x6a\x70\x65\147"))) { goto LdL9N; } goto Kf2hg; FV9A2: return $sFileNameS; goto L6XBc; L6XBc: } goto gFbf_; qjWPw: $GLOBALS["\x66\x72\x61\155\x65\x73"] = $this->getMainMenu(); goto uQsVx; d7Fz4: message("\350\xaf\xb7\xe5\x85\x88\xe5\256\x8c\xe6\x88\x90\345\205\xac\xe4\xbc\x97\345\217\267\xe6\x8e\xa5\345\205\245", $this->createWebUrl("\x67\x7a\167\170\x61\x70\x70\x6a\151\145\x72\165"), "\145\162\162\x6f\x72"); goto eB1we; kyPVL: if (!($gzwxapp["\151\x73\137\171\172"] != 1)) { goto PZ0_5; } goto d7Fz4; ZLkUs: U8goa: goto kyPVL; EaViL: function WxAPPToken($gzwxapp, $reset = false) { goto Khal8; hiV7F: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); goto jNblj; UgEB7: curl_close($ch); goto hyYhC; yj41K: YqY1E: goto LaIog; rSglA: $token_expire = time() + $data["\145\170\x70\151\x72\145\163\x5f\151\x6e"]; goto Y8_MU; PNScq: KAHrd: goto U8TIe; mzbKE: if (!$reset && time() + 100 < $gzwxapp["\x74\x6f\x6b\x65\156\137\x65\170\x70\151\162\x65"]) { goto YqY1E; } goto AoOv8; pMlo2: $ch = curl_init(); goto C10P0; jNblj: $res = $data = curl_exec($ch); goto UgEB7; bZ2dQ: $url = "\x68\164\x74\x70\x73\72\x2f\57\141\x70\151\x2e\x77\145\x69\x78\x69\x6e\56\x71\161\x2e\x63\x6f\x6d\57\143\147\151\x2d\x62\151\x6e\x2f\x74\x6f\153\x65\156\77\147\162\x61\x6e\x74\x5f\x74\171\x70\x65\x3d\x63\154\x69\145\x6e\x74\x5f\143\x72\x65\x64\145\156\x74\x69\x61\x6c\x26\x61\160\x70\151\x64\x3d" . $appid . "\x26\x73\145\x63\162\145\x74\x3d" . $secret . ''; goto pMlo2; pK6LD: die(json_encode(["\x73\x74\141\164\x75\x73" => 0, "\x6d\163\147" => "\xe8\216\xb7\xe5\217\x96\345\x85\xac\344\274\227\345\217\267\347\232\204\124\x6f\153\x65\x6e\345\xa4\xb1\350\264\245\357\274\x8c\xe8\xaf\267\xe6\xa3\200\346\x9f\245\345\205\254\xe4\274\x97\345\217\xb7\347\x9a\204\x41\160\160\x69\144\xe8\267\x9f\345\x85\254\344\274\227\xe5\x8f\267\xe7\232\x84\101\x70\160\x73\x65\x63\x72\145\164\xe6\230\xaf\xe5\x90\xa6\xe6\xad\xa3\xe7\241\256\x2c\xe5\xbe\256\xe4\277\xa1\xe6\216\245\345\x8f\243\350\277\x94\xe5\x9b\x9e\xe7\xbb\223\346\236\234\xe6\230\257\357\xbc\232" . $res])); goto jn4ki; HQ6oq: l0Coa: goto LL9Cr; jn4ki: goto KAHrd; goto K5jQV; k8WC3: if ($data["\141\143\x63\x65\163\x73\x5f\164\157\x6b\145\x6e"]) { goto M4nRL; } goto pK6LD; Aw6UA: $secret = $gzwxapp["\141\x70\x70\x73\145\143\x72\x65\164"]; goto bZ2dQ; Y8_MU: pdo_update("\x6a\171\x66\145\x6e\137\x67\172\x77\170\141\x70\x70", array("\141\x63\x63\145\x73\163\137\x74\x6f\x6b\145\x6e" => $accessToken, "\x74\157\x6b\145\156\137\145\170\x70\151\x72\145" => $token_expire), array("\165\156\x69\141\x63\x69\x64" => $_W["\165\156\151\141\x63\151\144"], "\151\144" => $gzwxapp["\151\x64"])); goto PNScq; LaIog: $accessToken = $gzwxapp["\x61\x63\x63\x65\x73\163\137\x74\157\x6b\145\x6e"]; goto HQ6oq; p7GqF: $accessToken = $data["\141\x63\143\x65\163\163\x5f\164\x6f\x6b\x65\156"]; goto rSglA; hyYhC: $data = json_decode($data, true); goto k8WC3; C10P0: curl_setopt($ch, CURLOPT_URL, $url); goto WMoh3; WMoh3: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto hiV7F; AoOv8: $appid = $gzwxapp["\141\160\x70\151\x64"]; goto Aw6UA; Khal8: global $_W, $_GPC; goto mzbKE; U8TIe: goto l0Coa; goto yj41K; K5jQV: M4nRL: goto p7GqF; LL9Cr: return $accessToken; goto o43H7; o43H7: } goto dnqWJ; LPQlF: $erweima2 = $qrcode . $picture_attach2; goto J0Pyf; J0Pyf: MakeWxAPPQR($gzwxapp, $accessToken, $set_txt, $erweima, $erweima2); goto kI3fS; hlh35: $accessToken = WxAPPToken($gzwxapp); goto cHitc; u93SD: function MakeWxAPPQR($gzwxapp, $accessToken, $set_txt, $path, $path2) { goto R2cMK; nryUX: chmod($qrcode, 0777); goto SLJg2; D7yn4: xunJH: goto pV1wT; o3_7z: load()->library("\161\162\x63\x6f\x64\x65"); goto Cvqfj; dm2FI: $resJson = curl_exec($ch); goto Pb6nW; AkyNn: return MakeWxAPPQR($gzwxapp, $accessToken, $set_txt, $path, $path2); goto Otngo; xjRRm: curl_setopt($ch, CURLOPT_POST, 1); goto WP8qd; Pb6nW: curl_close($ch); goto KPKWO; N91Vs: qG17a: goto wZPLQ; R2cMK: global $_W, $_GPC; goto U_1DG; pV1wT: QRcode::png($url, $path, $errorCorrectionLevel, $matrixPointSize); goto pWPDa; WP8qd: curl_setopt($ch, CURLOPT_POSTFIELDS, $reqParam); goto dm2FI; TCIhN: $qrcode = ATTACHMENT_ROOT . "\164\145\155\160\154\141\164\x65\x2f\161\162\x63\157\144\145\57"; goto ZVKJq; g2S2J: $ch = curl_init(); goto SII6Y; k6_bI: @unlink($path); goto D7yn4; EM4X6: getThumb($path, $path2, 300, 300); goto IQfhm; SII6Y: curl_setopt($ch, CURLOPT_URL, $url); goto mvk8Y; pWPDa: chmod($path, 0777); goto GAehH; ZVKJq: if (is_dir($qrcode)) { goto qPvqR; } goto xc16m; wZPLQ: if (!empty($res["\164\x69\x63\x6b\x65\x74"])) { goto y912s; } goto IFXaj; wpAey: goto XcPh9; goto QOqXS; pLv4L: message("\xe5\x85\254\xe4\xbc\x97\345\x8f\267\xe4\xb8\215\xe6\224\257\346\x8c\x81\350\256\xa2\351\230\x85\xe5\x8f\xb7", $this->createWebUrl("\141\x64\x64\x67\172\x77\x78\x61\x70\160\154\x69\163\164"), "\x65\162\x72\157\x72"); goto wpAey; SLJg2: qPvqR: goto r_vRu; GAehH: XcPh9: goto DcSoW; cT0a0: $accessToken = WxAPPToken($gzwxapp, true); goto AkyNn; U_1DG: if ($accessToken) { goto rvwnV; } goto xk9l5; XqPoM: $url = "\150\164\x74\x70\163\x3a\57\x2f\141\x70\151\56\167\x65\x69\170\151\x6e\x2e\x71\x71\x2e\143\x6f\x6d\x2f\x63\x67\x69\55\x62\x69\156\x2f\x71\162\143\x6f\x64\145\57\x63\x72\145\x61\x74\145\77\141\143\x63\145\163\163\137\164\157\153\145\156\x3d" . $accessToken; goto g2S2J; mZC9c: $reqParam = "\173\x22\141\x63\x74\151\x6f\156\137\x6e\x61\155\145\x22\72\x20\x22\x51\x52\137\x4c\x49\x4d\x49\124\137\x53\124\122\137\x53\x43\x45\x4e\x45\42\54\x20\x22\141\x63\164\151\157\156\x5f\151\156\x66\x6f\42\72\x20\173\42\163\x63\x65\156\145\x22\x3a\x20\x7b\x22\163\x63\145\156\145\137\163\164\162\42\72\40\x22\x6a\x69\171\157\x6e\147\137" . $set_txt . "\x22\x7d\x7d\x7d\xa\12"; goto XqPoM; WuS_t: if ($gzwxapp["\147\172\137\164\x79\160\x65"] == 1) { goto cmi0l; } goto pLv4L; IFXaj: message("\345\210\233\345\273\272\345\x85\xac\344\274\227\345\x8f\xb7\347\x9a\x84\344\xba\x8c\xe7\273\xb4\347\240\x81\xe5\244\261\xe8\xb4\245\xef\xbc\x8c\xe5\217\xaf\xe8\x83\xbd\xe6\230\xaf\345\205\254\344\xbc\227\xe5\x8f\xb7\xe8\277\230\xe6\xb2\xa1\xe5\xaf\xb9\xe6\216\xa5\345\xa5\275\xef\274\x8c\xe6\210\226\350\x80\205\xe5\205\254\344\274\227\xe5\x8f\267\x41\160\x70\151\144\350\xb7\237\345\205\xac\344\xbc\x97\xe5\x8f\267\xe7\x9a\x84\x41\160\160\163\145\143\162\x65\164\344\xb8\x8d\346\255\xa3\347\241\256", '', "\x65\x72\x72\x6f\x72"); goto pk9FJ; pk9FJ: y912s: goto pIW2E; Cvqfj: $errorCorrectionLevel = "\x4c"; goto ZMm4_; mvk8Y: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto bqbZz; ZMm4_: $matrixPointSize = 5; goto WuS_t; KPKWO: $res = json_decode($resJson, true); goto q1mvH; bMBrX: $url = $res["\165\x72\154"]; goto TCIhN; IVvqj: return MakeWxAPPQR($gzwxapp, $accessToken, $set_txt, $path, $path2); goto kNE7a; Mqzn4: message("\xe8\216\267\345\x8f\x96\345\x85\xac\xe4\xbc\227\345\x8f\xb7\xe7\224\x9f\xe6\210\220\344\xba\x8c\347\xbb\264\347\xa0\201\xe5\x87\xba\351\x94\x99\357\274\x8c\xe5\276\256\xe4\277\241\xe6\x8e\245\xe5\217\xa3\350\277\224\xe5\x9b\x9e\xe7\273\x93\346\x9e\x9c\xe6\230\xaf\357\xbc\x9a" . $resJson, '', "\x65\162\x72\157\162"); goto N91Vs; r_vRu: if (!file_exists($path)) { goto xunJH; } goto k6_bI; pIW2E: $ticket = $res["\164\151\x63\x6b\x65\x74"]; goto bMBrX; xk9l5: $accessToken = WxAPPToken($gzwxapp, true); goto IVvqj; DcSoW: if (!file_exists($path2)) { goto QRmB5; } goto vIAOV; kNE7a: rvwnV: goto o3_7z; QOqXS: cmi0l: goto mZC9c; q1mvH: if (!($res["\145\162\162\143\x6f\144\x65"] === 40001)) { goto oOqKI; } goto cT0a0; Otngo: oOqKI: goto dq7D9; bqbZz: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); goto xjRRm; xc16m: mkdir($qrcode, 0777, true); goto nryUX; vIAOV: @unlink($path2); goto yj1AQ; dq7D9: if (!$res["\x65\x72\162\143\x6f\144\x65"]) { goto qG17a; } goto Mqzn4; yj1AQ: QRmB5: goto EM4X6; IQfhm: } goto zenN1; gFbf_: function resizeImage($im, $dest, $maxwidth, $maxheight) { goto llH_x; sA_83: POsg6: goto aTc_i; qzi7V: $pic_width = imagesx($im); goto onWCu; LVV9B: goto mZzUM; goto sA_83; IeFiO: j7_dL: goto qzi7V; mF4UT: if (!($resizeheight_tag && !$resizewidth_tag)) { goto DBb2p; } goto uk8la; nxxlr: $newheight = $pic_height * $ratio; goto AgYDw; t4tr3: if (!($maxheight && $pic_height > $maxheight)) { goto hoUwX; } goto v8X7Y; htrb2: imagecopyresized($newim, $im, 0, 0, 0, 0, $newwidth, $newheight, $pic_width, $pic_height); goto gRgQ7; Kw_7f: imagecopyresampled($newim, $im, 0, 0, 0, 0, $newwidth, $newheight, $pic_width, $pic_height); goto GYR6w; h7OFj: hoUwX: goto OEgPU; WBTTh: $ratio = $heightratio; goto LVV9B; ykNdE: $resizewidth_tag = false; goto ZawfV; GGPGb: QhA27: goto IBByQ; VuxoC: if ($maxwidth && $pic_width > $maxwidth || $maxheight && $pic_height > $maxheight) { goto UaUbq; } goto sc0PU; A8UbZ: Q0tCY: goto duMNe; v8X7Y: $heightratio = $maxheight / $pic_height; goto E33oK; XnyyT: VSl5Q: goto CAzJp; IBByQ: $newim = imagecreatetruecolor($newwidth, $newheight); goto Kw_7f; ZawfV: $resizeheight_tag = false; goto VuxoC; Sxs4f: mZzUM: goto XnyyT; pI117: DBb2p: goto olnHQ; u5GLT: $ratio = $widthratio; goto eqZW0; Ls59M: B_F2B: goto t4tr3; jus7y: UaUbq: goto mkBxe; UwZw2: goto Q0tCY; goto jus7y; qFqH1: chmod($dest, 0777); goto UwZw2; AgYDw: if (function_exists("\151\155\141\x67\145\143\157\x70\171\162\145\163\x61\x6d\160\x6c\x65\144")) { goto QhA27; } goto S3XrG; GYR6w: Cqmje: goto ITPax; OEgPU: if (!($resizewidth_tag && $resizeheight_tag)) { goto VSl5Q; } goto b6Pcb; olnHQ: $newwidth = $pic_width * $ratio; goto nxxlr; E33oK: $resizeheight_tag = true; goto h7OFj; eqZW0: w70Wq: goto mF4UT; ifyzn: o_4rH: goto IeFiO; gRgQ7: goto Cqmje; goto GGPGb; F67vt: switch ($img[2]) { case 1: $im = @imagecreatefromgif($im); goto j7_dL; case 2: $im = @imagecreatefromjpeg($im); goto j7_dL; case 3: $im = @imagecreatefrompng($im); goto j7_dL; } goto ifyzn; ZeTnv: $widthratio = $maxwidth / $pic_width; goto R5TWN; Xwj2t: chmod($dest, 0777); goto g81iV; CAzJp: if (!($resizewidth_tag && !$resizeheight_tag)) { goto w70Wq; } goto u5GLT; b6Pcb: if ($widthratio < $heightratio) { goto POsg6; } goto WBTTh; mkBxe: if (!($maxwidth && $pic_width > $maxwidth)) { goto B_F2B; } goto ZeTnv; ITPax: imagejpeg($newim, $dest); goto Xwj2t; S3XrG: $newim = imagecreate($newwidth, $newheight); goto htrb2; g81iV: imagedestroy($newim); goto A8UbZ; R5TWN: $resizewidth_tag = true; goto Ls59M; sc0PU: imagejpeg($im, $dest); goto qFqH1; onWCu: $pic_height = imagesy($im); goto ykNdE; aTc_i: $ratio = $widthratio; goto Sxs4f; uk8la: $ratio = $heightratio; goto pI117; llH_x: $img = getimagesize($im); goto F67vt; duMNe: } goto u93SD; Y7Dfu: message("\350\xaf\xb7\345\x85\210\345\xae\214\xe5\x96\204\xe5\x85\254\344\xbc\227\345\x8f\xb7\350\xae\276\xe7\xbd\xae", $this->createWebUrl("\141\x64\x64\x67\172\167\x78\141\x70\x70\x6c\x69\x73\x74"), "\145\x72\x72\x6f\x72"); goto ZLkUs; DZXCY: if ($gzwxapp) { goto U8goa; } goto Y7Dfu; S2mo9: $qrcode = MODULE_ROOT . "\57\x74\x65\x6d\x70\x6c\x61\164\x65\x2f\x71\162\x63\x6f\x64\145\57"; goto xeo2k; kI3fS: $qrcode_url = str_replace(MODULE_ROOT, MODULE_URL, $erweima2); goto mwYRr; ukfJ7: global $_GPC, $_W; goto qjWPw; eB1we: PZ0_5: goto EaViL; ziRiP: $picture_attach2 = "\167\170\141\x70\x70\x33\60\60\55\x67\172\x79\x71\56\160\156\147"; goto O4WxK; mwYRr: include $this->template("\x77\145\142\x2f\147\x7a\161\162\x63\157\x64\145");